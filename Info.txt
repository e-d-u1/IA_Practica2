
(defrule establecer-precio
   ?s <- (object (is-a Solicitante) (precioMin ?pMin) (precioMax ?pMax) (precioNegociable ?negociable))
   ?v <- (object (is-a Vivienda))
   
   =>
   
   (bind ?precioCasa (send ?v get-precio))

   (if (>= ?pMax ?precioCasa)
    then
       (send ?v put-rangoPrecio "Ajustado")
    else
       (if (and (eq ?negociable TRUE)
                (>= (* ?pMax 1.5) ?precioCasa))
           then
               (send ?v put-rangoPrecio "Aceptable")
           else
               (send ?v put-rangoPrecio "Fuera")))    
)


   ;; ---- DEBUG INFO ----
   (printout t crlf
                "*** DEBUG ESTABLECER-PRECIO ***" crlf
                "Solicitante: " (instance-name ?s) crlf
                "Vivienda:    " (instance-name ?v) crlf
                "precioMin:   " ?pMin crlf
                "precioMax:   " ?pMax crlf
                "negociable:  " ?negociable crlf
                "precioCasa:  " ?precioCasa crlf
                "Comparación precioMax >= precioCasa → "
                (>= ?pMax ?precioCasa) crlf
                "Comparación negociable AND (*precioMax 1.5) >= precioCasa → "
                (and (eq ?negociable "true") (>= (* ?pMax 1.5) ?precioCasa)) crlf
                "----------------------------------" crlf)
;; ---- PRINT FINAL ----
   (printout t "VIVIENDA " (instance-name ?v)
                "  → precio: " ?precioCasa
                " | rango: " (send ?v get-rangoPrecio)
                " | solicitante: " (instance-name ?s)
                crlf)

Diferencia entre sacar precio en la LHS o bindearlo en la RHS?

Duda: Si recomendamos una vivienda a un Solicitante puede ser recomendada a otro no?